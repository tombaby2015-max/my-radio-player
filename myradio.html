<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Мини-радио (iOS9)</title>
<style>
  html,body{height:100%;margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;}
  .wrap{min-height:100%;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:18px;box-sizing:border-box;background:#f7f7f7;color:#111}
  .card{width:100%;max-width:420px;background:#fff;border-radius:10px;box-shadow:0 6px 18px rgba(0,0,0,0.08);padding:18px;text-align:center}
  h1{font-size:18px;margin:0 0 8px}
  p{margin:6px 0 14px;font-size:13px;color:#555}
  button{appearance:none;border:0;padding:12px 18px;border-radius:8px;font-size:16px;background:#0a84ff;color:white;cursor:pointer}
  button.secondary{background:#e5e7eb;color:#111}
  #status{margin-top:10px;font-size:13px;color:#666}
  /* скрываем визуальный элемент <video> (он нужен для звука) */
  video{display:none}
</style>
</head>
<body>
<div class="wrap">
  <div class="card">
    <h1>Svoe FM — радио</h1>
    <p>Плеер для iOS9 / Safari. Нажмите «Play» для запуска.</p>

    <button id="playBtn">Play</button>
    <button id="stopBtn" class="secondary" style="margin-left:8px">Pause</button>

    <div id="status">Готово</div>

    <!-- Video элемент используется как nативный HLS плеер в Safari.
         Если хотите использовать audio, можно заменить на <audio>. -->
    <video id="player" preload="none" playsinline webkit-playsinline>
      <source src="https://h.getradio.me/svoefm/hls.m3u8" type="application/vnd.apple.mpegurl">
      <!-- fallback текст -->
      Ваш браузер не поддерживает поток HLS.
    </video>
  </div>
</div>

<script>
(function(){
  var player = document.getElementById('player');
  var playBtn = document.getElementById('playBtn');
  var stopBtn = document.getElementById('stopBtn');
  var status = document.getElementById('status');

  function setStatus(t){ status.textContent = t; }

  playBtn.addEventListener('click', function(){
    // пользовательское действие — позволяет начать воспроизведение
    player.load(); // убедиться, что источник загружен
    var p = player.play();
    if (p && p.then) {
      p.then(function(){ setStatus('Играет'); })
       .catch(function(err){
         console.error('play error', err);
         setStatus('Ошибка воспроизведения: ' + (err && err.message ? err.message : 'неизвестно'));
       });
    } else {
      // старые браузеры: no promise
      setStatus('Инициализация...');
      // ставим таймаут — через короткое время проверим paused
      setTimeout(function(){ setStatus(player.paused ? 'Не удалось запустить' : 'Играет'); }, 800);
    }
  });

  stopBtn.addEventListener('click', function(){
    try { player.pause(); setStatus('Пауза'); } catch(e){ setStatus('Ошибка паузы'); }
  });

  // события для информирования
  player.addEventListener('waiting', function(){ setStatus('Буферизация...'); });
  player.addEventListener('playing', function(){ setStatus('Играет'); });
  player.addEventListener('pause', function(){ setStatus('Пауза'); });
  player.addEventListener('error', function(){
    var e = player.error;
    var msg = 'Ошибка потока';
    if (e) msg += ' (code ' + e.code + ')';
    setStatus(msg);
  });

})();
</script>
</body>
</html>
